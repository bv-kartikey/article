<h1><%= @post.title %></h1>

<p><%= @post.body %></p>

<%= link_to "Edit", edit_post_path(@post) %> |
<%= link_to "Back", posts_path %> |
<%= link_to "Delete", post_path(@post), method: :delete, data: { confirm: "Are you sure?" } %>


<h3>Comments:</h3>

<% @post.comments.each do |comment| %>
  <p>
    <strong><%= comment.user.email %>:</strong>
    <%= comment.body %>

    <% if comment.user == current_user %>
      <%= link_to "Delete", post_comment_path(@post, comment),
          method: :delete,
          data: { confirm: "Delete this comment?" } %>
    <% end %>
  </p>
<% end %>

<% if user_signed_in? %>
  <h4>Add a Comment:</h4>
  <%= form_with(model: [@post, Comment.new]) do |f| %>
    <div>
      <%= f.text_area :body, rows: 3 %>
    </div>
    <%= f.submit "Post Comment" %>
  <% end %>
<% else %>
  <p>You must <%= link_to "login", new_user_session_path %> to comment.</p>
<% end %>
